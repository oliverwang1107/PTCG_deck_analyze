# PTCG City League ç‰Œçµ„åˆ†æç³»çµ±

å¾ [Limitless TCG](https://limitlesstcg.com) çˆ¬å–æ—¥æœ¬ City League è³½äº‹è³‡æ–™ï¼Œåˆ†æç‰Œçµ„åŸå‹åˆ†å¸ƒã€å‹ç‡ã€å°æˆ°å„ªåŠ£å‹¢èˆ‡æ§‹ç¯‰è¶¨å‹¢ï¼Œä¸¦ä»¥ä¸­æ–‡åŒ–ç¶²é ä»‹é¢å‘ˆç¾ã€‚

## åŠŸèƒ½ç‰¹è‰²

- ğŸ† **ç‰Œçµ„åŸå‹åˆ†æ** â€” çµ±è¨ˆå„åŸå‹ä½¿ç”¨ç‡ã€Top 8 å…¥åœç‡ã€å„ªå‹ç‡
- ğŸ“Š **å‹ç‡åˆ†æ** â€” å„åŸå‹æ•´é«”å‹ç‡èˆ‡æ™‰ç´šç‡
- âš”ï¸ **å°æˆ°å„ªåŠ£å‹¢** â€” åŸºæ–¼è³½äº‹æ’åæ¨ç®—çš„å°æˆ°å‹ç‡çŸ©é™£ï¼ˆç†±åŠ›åœ–ï¼‰
- ğŸƒ **æ§‹ç¯‰è¶¨å‹¢** â€” æ ¸å¿ƒå¡ç‰‡ã€é¸é…å¡ç‰‡ã€ACE SPEC ä½¿ç”¨çµ±è¨ˆ
- ğŸŒ **ä¸­æ–‡åŒ–** â€” æ•´åˆç¹é«”ä¸­æ–‡å¡ç‰Œè³‡æ–™åº«ï¼Œé¡¯ç¤ºä¸­æ–‡å¡åèˆ‡å¡åœ–
- ğŸ“… **æ¯é€±åˆ†çµ„** â€” æŒ‰é€±æŸ¥çœ‹è³½äº‹è¶¨å‹¢è®ŠåŒ–

---

## å®‰è£

éœ€è¦ Python 3.11+ èˆ‡ [uv](https://docs.astral.sh/uv/)ã€‚

```bash
# Clone å°ˆæ¡ˆ
git clone <repo-url>
cd PTCG_deck_analyze

# å®‰è£ä¾è³´ï¼ˆuv æœƒè‡ªå‹•å»ºç«‹è™›æ“¬ç’°å¢ƒï¼‰
uv sync
```

---

## å¿«é€Ÿé–‹å§‹

### ä¸€éµå·¥ä½œæµç¨‹

æœ€ç°¡å–®çš„æ–¹å¼æ˜¯ä½¿ç”¨ `workflow` æŒ‡ä»¤ï¼Œå®ƒæœƒä¾åºå®Œæˆï¼šåŒæ­¥å¡ç‰Œè³‡æ–™åº« â†’ çˆ¬å–è³½äº‹è³‡æ–™ â†’ æ›´æ–°å¡ç‰Œæ˜ å°„ã€‚

```bash
# å®Œæ•´å·¥ä½œæµç¨‹ï¼ˆåŒæ­¥å¡ç‰Œ DB + çˆ¬å–æœ€è¿‘ 14 å¤©è³½äº‹ï¼‰
uv run python -m src.main workflow

# è·³éå¡ç‰Œè³‡æ–™åº«åŒæ­¥ï¼ˆæ›´å¿«ï¼‰
uv run python -m src.main workflow --skip-cards

# æŒ‡å®šå¤©æ•¸
uv run python -m src.main workflow --skip-cards --days 30
```

### å•Ÿå‹•ç¶²é ä»‹é¢

```bash
uv run python -m src.main web
```

ç„¶å¾Œåœ¨ç€è¦½å™¨æ‰“é–‹ **http://localhost:5000** å³å¯çœ‹åˆ°åˆ†æçµæœã€‚

---

## æŒ‡ä»¤èªªæ˜

### `scrape` â€” çˆ¬å–è³½äº‹è³‡æ–™

```bash
# çˆ¬å–æœ€è¿‘ 20 å ´è³½äº‹ï¼ˆé è¨­ï¼‰
uv run python -m src.main scrape

# çˆ¬å–æœ€è¿‘ 10 å ´ï¼Œä¸¦æŠ“å–è©³ç´°å¡è¡¨
uv run python -m src.main scrape --limit 10 --fetch-cards

# çˆ¬å–æœ€è¿‘ 30 å¤©çš„è³½äº‹
uv run python -m src.main scrape --days 30 --fetch-cards

# æ›´æ–° Limitless â†’ ä¸­æ–‡å¡ç‰Œæ˜ å°„
uv run python -m src.main scrape --update-card-map
```

| åƒæ•¸ | èªªæ˜ |
|------|------|
| `--limit N` | æœ€å¤šçˆ¬å– N å ´è³½äº‹ï¼ˆé è¨­ 20ï¼‰ |
| `--days N` | çˆ¬å–æœ€è¿‘ N å¤©çš„è³½äº‹ |
| `--fetch-cards` | æŠ“å–æ¯å‰¯ç‰Œçš„è©³ç´°å¡è¡¨ï¼ˆè¼ƒæ…¢ï¼Œä½†å•Ÿç”¨å¡ç‰Œåˆ†æï¼‰ |
| `--update-card-map` | æ›´æ–° Limitless å¡ç‰Œ ID åˆ°ä¸­æ–‡è³‡æ–™åº«çš„æ˜ å°„ |
| `--delay N` | è«‹æ±‚é–“éš”ç§’æ•¸ï¼ˆé è¨­ 1.0ï¼‰ |

### `analyze` â€” å‘½ä»¤åˆ—åˆ†æ

```bash
# é¡¯ç¤ºæ•´é«”ç’°å¢ƒæ¦‚è¦½
uv run python -m src.main analyze

# æŸ¥çœ‹ç‰¹å®šç‰Œçµ„çš„è©³ç´°åˆ†æ
uv run python -m src.main analyze --archetype "dragapult / dusknoir"
```

### `web` â€” ç¶²é ä»‹é¢

```bash
# å•Ÿå‹•ï¼ˆé è¨­ 127.0.0.1:5000ï¼‰
uv run python -m src.main web

# æŒ‡å®š port
uv run python -m src.main web --port 8080

# é–‹å•Ÿ debug æ¨¡å¼
uv run python -m src.main web --debug
```

### `cards` â€” å¡ç‰Œè³‡æ–™åº«ç®¡ç†

```bash
# åŒæ­¥ç¹ä¸­å¡ç‰Œè³‡æ–™ï¼ˆHã€Iã€J è¦å‰‡æ¨™è¨˜ï¼‰
uv run python -m src.main cards sync --regulation-mark H,I,J

# æŸ¥è©¢å¡ç‰‡
uv run python -m src.main cards query --name "å™´ç«é¾"
```

### `workflow` â€” ä¸€éµæ›´æ–°å…¨éƒ¨è³‡æ–™

```bash
# å®Œæ•´æµç¨‹ï¼šåŒæ­¥å¡ç‰Œ DB â†’ çˆ¬å–è³½äº‹ â†’ æ›´æ–°æ˜ å°„
uv run python -m src.main workflow

# è·³éå¡ç‰ŒåŒæ­¥ï¼ˆå·²æœ‰è³‡æ–™åº«æ™‚æ¨è–¦ï¼‰
uv run python -m src.main workflow --skip-cards

# æŒ‡å®šå¤©æ•¸ç¯„åœ
uv run python -m src.main workflow --days 7
```

---

## å…¸å‹ä½¿ç”¨æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. é¦–æ¬¡ä½¿ç”¨                                  â”‚
â”‚     uv run python -m src.main workflow       â”‚
â”‚     (ç´„éœ€ 5-10 åˆ†é˜ï¼Œçˆ¬å–è³‡æ–™ + å»ºç«‹æ˜ å°„)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. æ—¥å¸¸æ›´æ–°                                  â”‚
â”‚     uv run python -m src.main workflow       â”‚
â”‚       --skip-cards --days 7                  â”‚
â”‚     (ç´„éœ€ 1-3 åˆ†é˜)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. æŸ¥çœ‹åˆ†æçµæœ                              â”‚
â”‚     uv run python -m src.main web            â”‚
â”‚     â†’ ç€è¦½å™¨æ‰“é–‹ http://localhost:5000        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å°ˆæ¡ˆçµæ§‹

```
PTCG_deck_analyze/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.py              # CLI å…¥å£
â”‚   â”œâ”€â”€ translation.py       # å¯¶å¯å¤¢ä¸­æ–‡ç¿»è­¯
â”‚   â”œâ”€â”€ scraper/
â”‚   â”‚   â”œâ”€â”€ limitless.py     # Limitless TCG çˆ¬èŸ²
â”‚   â”‚   â”œâ”€â”€ mapper.py        # å¡ç‰Œ ID æ˜ å°„ (Limitless â†’ JP)
â”‚   â”‚   â””â”€â”€ models.py        # è³‡æ–™æ¨¡å‹
â”‚   â”œâ”€â”€ analyzer/
â”‚   â”‚   â”œâ”€â”€ archetype.py     # ç‰Œçµ„åŸå‹åˆ†æ
â”‚   â”‚   â”œâ”€â”€ winrate.py       # å‹ç‡åˆ†æ
â”‚   â”‚   â”œâ”€â”€ trends.py        # æ§‹ç¯‰è¶¨å‹¢åˆ†æ
â”‚   â”‚   â”œâ”€â”€ matchups.py      # å°æˆ°å„ªåŠ£å‹¢åˆ†æ
â”‚   â”‚   â””â”€â”€ cards.py         # å¡ç‰Œä½¿ç”¨çµ±è¨ˆ
â”‚   â”œâ”€â”€ card_db/             # ç¹ä¸­å¡ç‰Œè³‡æ–™åº«å·¥å…·
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ card_db.py       # å¡ç‰Œè³‡æ–™åº«æŸ¥è©¢ä»‹é¢
â”‚   â””â”€â”€ web/
â”‚       â”œâ”€â”€ app.py           # Flask æ‡‰ç”¨ & API
â”‚       â””â”€â”€ templates/
â”‚           â””â”€â”€ index.html   # å‰ç«¯ä»‹é¢
â”œâ”€â”€ data/                    # å¿«å–è³‡æ–™
â”‚   â”œâ”€â”€ scraped_data.json    # çˆ¬å–çš„è³½äº‹è³‡æ–™
â”‚   â”œâ”€â”€ limitless_jp_map.json # å¡ç‰Œ ID æ˜ å°„è¡¨
â”‚   â””â”€â”€ ptcg_hij.sqlite      # ç¹ä¸­å¡ç‰Œè³‡æ–™åº«
â””â”€â”€ pyproject.toml
```

---

## API ç«¯é»

å•Ÿå‹• web å¾Œå¯ç›´æ¥å‘¼å«ä»¥ä¸‹ APIï¼š

| ç«¯é» | èªªæ˜ |
|------|------|
| `GET /api/overview` | ç’°å¢ƒæ¦‚è¦½çµ±è¨ˆ |
| `GET /api/archetypes` | ç‰Œçµ„åŸå‹åˆ†å¸ƒ |
| `GET /api/archetypes/chinese` | ç‰Œçµ„åŸå‹åˆ†å¸ƒï¼ˆä¸­æ–‡ï¼‰ |
| `GET /api/archetype/<name>/detail` | ç‰¹å®šåŸå‹è©³ç´°åˆ†æ |
| `GET /api/winrates` | å‹ç‡çµ±è¨ˆ |
| `GET /api/matchups` | å°æˆ°å‹ç‡çŸ©é™£ |
| `GET /api/matchups/chinese` | å°æˆ°å‹ç‡çŸ©é™£ï¼ˆä¸­æ–‡ï¼‰ |
| `GET /api/trends` | ç’°å¢ƒè¶¨å‹¢ |
| `GET /api/tournaments/weekly` | æ¯é€±è³½äº‹åˆ†çµ„ |
